<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>{{ t.threads_title }}</title>
<style>{{ inline_css }}</style>
<script>window.variantTexts = {{ t.variant_texts | tojson | safe }};</script>
<script src="static/variant.js"></script>
</head>
<body>
  <div class="page-shell page-shell--full">
  <header class="page-header column">
    <h1>{{ t.threads_title }}</h1>
    <p class="meta">{{ t.generated_label }} {{ generated_at }}</p>
    <div class="legend">
      {% for item in t.legend_table %}<span>{{ item }}</span>{% endfor %}
    </div>
    <p class="meta"><a class="action-link" href="index.html">{{ t.back_to_index }}</a></p>
  </header>

  <table class="score-table">
    <thead>
      <tr>
        <th rowspan="2">Name</th>
        <th rowspan="2" class="narrow">V</th>
        {% for task in thread_tasks %}
          {% set letters = ['S','D','C','R'] if task.name == 'seq' else ['S','P','A','E','D','C','R'] %}
          <th colspan="{{ letters | length }}" class="task-header">
            <div class="task-title">
              <span class="task-name">{{ task.display_name }}</span>
              {% if deadlines.get(task.name) %}<span class="deadline">{{ deadlines.get(task.name) }}</span>{% endif %}
            </div>
          </th>
        {% endfor %}
        <th rowspan="2" class="narrow">Total</th>
      </tr>
      <tr>
        {% for task in thread_tasks %}
          {% set letters = ['S','D','C','R'] if task.name == 'seq' else ['S','P','A','E','D','C','R'] %}
          {% for letter in letters %}
            <th class="narrow">{{ letter }}</th>
          {% endfor %}
        {% endfor %}
      </tr>
    </thead>
    <tbody>
      {% for row in rows %}
        <tr data-last="{{ row.student.last_name|default('') }}" data-first="{{ row.student.first_name|default('') }}" data-middle="{{ row.student.middle_name|default('') }}" data-group="{{ row.student.group_number|default('') }}">
          <td class="name">{{ row.name|safe }}</td>
          <td class="narrow variant-cell">â€”</td>
          {% for task in thread_tasks %}
            {% set cell = row.cells[task.name] %}
            {% if task.name == 'seq' %}
              <td class="narrow {{ cell.solution_class }}">{{ cell.solution_points }}</td>
              <td class="narrow deadline-cell">{{ cell.deadline_penalty }}</td>
              <td class="narrow {{ cell.copy_class }}">{{ cell.copy_penalty }}</td>
              <td class="narrow {{ cell.report_class }}">{{ cell.report_points }}</td>
            {% else %}
              <td class="narrow {{ cell.solution_class }}">{{ cell.solution_points }}</td>
              <td class="narrow perf-cell">{{ cell.performance_display }}</td>
              <td class="narrow perf-cell">{{ cell.acceleration }}</td>
              <td class="narrow perf-cell">{{ cell.efficiency }}</td>
              <td class="narrow deadline-cell">{{ cell.deadline_penalty }}</td>
              <td class="narrow {{ cell.copy_class }}">{{ cell.copy_penalty }}</td>
              <td class="narrow {{ cell.report_class }}">{{ cell.report_points }}</td>
            {% endif %}
          {% endfor %}
          <td class="narrow total">{{ '%.2f'|format(row.total) }}</td>
        </tr>
      {% endfor %}
    </tbody>
  </table>
  <script>
    variantCalc.fillThreadsTable({{ repo_salt | tojson | safe }}, {{ threads_vmax | int }});
  </script>
  </div>
</body>
</html>
