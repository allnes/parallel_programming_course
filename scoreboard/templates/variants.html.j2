<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>{{ t.variants_title }}</title>
<style>{{ inline_css }}</style>
  <script>window.variantTexts = {{ t.variant_texts | tojson | safe }};</script>
<script src="static/variant.js"></script>
</head>
<body>
  <div class="page-shell">
  <header class="page-header">
    <div>
      <h1>{{ t.variants_title }}</h1>
      <p class="meta">{{ t.generated_label }} {{ generated_at }}</p>
      <p class="meta"><a class="action-link" href="index.html">{{ t.back_to_index }}</a></p>
    </div>
    <div class="legend">
      <span>{{ t.variant_legend_threads }}</span>
      <span>{{ t.variant_legend_processes }}</span>
    </div>
  </header>

  <section class="nav-section">
    <h2>{{ t.variant_calc_title }}</h2>
    <div style="display:flex; gap:12px; flex-wrap:wrap; align-items:flex-end;">
      <label><input type="radio" name="sem" value="threads" checked> {{ t.threads_label }}</label>
      <label><input type="radio" name="sem" value="processes"> {{ t.processes_label }}</label>
      <label>{{ t.variant_form_last }}<br><input id="v_last" type="text" style="width:160px"></label>
      <label>{{ t.variant_form_first }}<br><input id="v_first" type="text" style="width:160px"></label>
      <label>{{ t.variant_form_middle }}<br><input id="v_middle" type="text" style="width:160px"></label>
      <label>{{ t.variant_form_group }}<br><input id="v_group" type="text" style="width:160px"></label>
      <button id="v_calc" style="height:40px;">{{ t.variant_form_button }}</button>
      <div id="v_result" style="min-width:200px; font-weight:700; color:#2563eb;"></div>
    </div>
    <p class="muted" style="margin-top:6px;">{{ t.variant_hint }}</p>
  </section>

  <script>
    variantCalc.attachForm(
      {{ repo_salt | tojson | safe }},
      {{ threads_vmax | int }},
      {{ proc_vmaxes | tojson | safe }}
    );
    variantCalc.fillThreadsTable({{ repo_salt | tojson | safe }}, {{ threads_vmax | int }});
    variantCalc.fillProcessesTable(
      {{ repo_salt | tojson | safe }},
      {{ proc_vmaxes | tojson | safe }},
      {{ proc_tasks | map(attribute='display_name') | list | tojson | safe }}
    );
  </script>
  </div>
</body>
</html>
